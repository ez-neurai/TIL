# 뇌파 신호의 특성 및 분석법 下 편
## 뇌파 신호의 안정성
뇌파 신호는 뇌 기능 상태를 실시간으로 잘 반영함과 동시에 동일한 피실험자에게서 같은 실험 조건으로 반복 측정했을 때 변이가 크지 않아 매우 안정적인 신호라고 할 수 있다. 오차는 대략 1 Hz 이내이며, 만일 1 Hz 이상 차이가 나면 뇌의 구조나 기능에 변화가 있음을 시사한다.  

<br>

뇌파는 유전적인 소인에 의해 상당 부분 결정된다. 뇌파는 ACh, dopamine, serotonin 등 많은 neurotransmitter 의 상호 작용으로 발생되는데, 이러한 neurotransmitter 들은 유전적으로 결정되고 조절되기 때문이다.

<br>

## 정량적 뇌파 분석의 종류
뇌파의 정량적 분석의 목적은 어떤 특성을 추출하여 이를 정량화하거나, 이를 기반으로 분류하고 예측하는 것에 있다. 또한 특정 파형을 추출하거나 제거하는 데에도 사용된다.

여기서 중요한 것은 연구 목적에 맞는 혹은 알고자 하는 목적에 맞는 적절한 뇌파 특성을 선택해야 하며, 이에 따른 적합한 분석 방법이 적용되어야 한다는 것이다.

이를 위해서는 획득된 뇌파 자료의 특징을 잘 파악하여야 한다. 예를 들어 안정 상태에서 조용히 눈을 감은 상태의 뇌파와 수면중의 뇌파 그리고 인지 자극에 반응하는 뇌파는 서로 데이터의 특성이 매우 다르므로 어떤 특성을 추출하고 어떤 분석법을 적용할지를 잘 결정해야 한다.  

<br>

| 뇌파 신호 특성 | 이유 | 분석 방법 |
|:----------:|:---:|:-------:| 
|시계열  |시간에 따른 전위의 연속적인 변화|안정 뇌파, 사건유발전위, 통계 분석 (linear), 카오스 이론 분석 (non-linear)
|진동  |신경 세포 및 세포 집단 간 상호 작용에 의한 뇌파의 신호| 주파수 : 푸리에 분석, 웨이블릿 분석 <br> 진폭 (power) : ERS, ERSP <br> 위상 : coherence, PLV, PLI
|지형학적 정보 |다채널 전위 기록에 의한 지형학적 공간 정보|뇌 매핑 : 전위 지도, 주파수 지도 <br> 신호원국지화
|네트워크 구조|기능적인 연결성에 의한 대뇌 영역 간의 상호 작용| 국소적 혹은 전반적 연결 구조 분석 : clustering <br> coefficient, path length, hub

## > 시간축 분석 기법
뇌파는 전위가 연속적으로 변화하는 시계열 신호이므로 다양한 **시간축 분석 기법**을 적용할 수 있다.

## > 주파수축 분석 기법
뇌파의 진동 특성을 분석하는 방법이 주파수축 분석이다. 진동하는 파는 **주파수, 진폭, 위상각** 의 정보를 가진다. 3가지 진동 특성은 오일러 공식 및 이를 복소평면에 표현할 수 있다.

<br>

![복소평면 위에 표현한 오일러 공식](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2F3TlG3%2FbtqZ0tITc8H%2FnSgR77JSgwKFj5pLnXKevK%2Fimg.png)

<br>

진동하는 파형은 원점을 기점으로 **반시계 방향**으로 회전하는 것으로 표현할 수 있고, **반지름은 파형의 크기** 즉, 진폭 (진폭^2 = 에너지), **각도는 특정 시점에서의 위상**이 된다. **주파수는 1 초에 회전하는 수**이다.

모든 신호는 다양한 주파수의 사인 파동 (sinusoidal wave) 의 복합체로 이루어졌다고 가정할 수 있다. 주파수 분석에는 주어진 시간 절편 내에서의 주파수 성분을 분석하는 **푸리에 변환법**이 주로 사용되는데, 전 시간 영역 동안의 주파수 성분을 추출하기에 결과적으로 얻어진 주파수 성분이 시간상으로 엄밀하게 **어느 시점에서 발생한 신호의 요소인지 알아낼 수 없게 된다.**

이에 시간에 띠른 주파수 성분의 변화를 보기 위해 **단시간 푸리에 변환 (short-time Fourier transform)** 이나 **웨이블릿 (wavelet) 분석**이 많이 사용된다. 단시간 푸리에 변환은 상당히 작은 시간폭 단위 ; window 로 푸리에 변환을 시간축에 따라 이동하면서 얻는 주파수 성분 분석법으로, **window ; 창 의 크기가 고정되어 있어 저주파에서는 시간 정밀도가 감소하고, 고주파에서는 주파수 정밀도가 감소하는 문제가 발생**한다.

<br>

> 이 현상의 원인은 시간 분해능<sup>[1](#시간분해능)</sup>과 주파수 분해능<sup>[2](#주파수분해능)</sup> 간의 균형과 관련이 있다.
고정된 크기의 창을 사용하여 신호를 분석할 때, 신호에 대해 얻을 수 있는 **정보의 양은 창 크기에 의해 제한된다.**  
저주파에서는 주기가 긴 탓에 전체 주기를 완료하는 데 더 많은 시간이 걸리게 된다. 그 결과 창 내에서 신호의 주기가 줄어들어 시간 분해능이 떨어지게 되고 <span style='background-color: #fff5b1'> 신호가 발생한 정확한 타이밍을 알기 어렵게 된다.</span>  
고주파에서는 주기가 더 짧아 전체 주기를 완료하는 데 걸리는 시간이 더 짧다. 이로 인해 창 내에서 더 많은 신호 주기가 발생하여 주파수 분해능이 감소하게 되어 <span style='background-color: #fff5b1'>신호를 구성하는 정확한 주파수 구성 요소에 대한 정보를 얻기 힘들어진다.</span> 
이러한 현상은 신호 분석에서의 **하이젠베르크의 불확정성 원리**로 알려져 있다. 입자의 위치와 운동량을 동시에 정확히 측정할 수 없다는 것인데 신호의 시간 (위치) 와 주파수 (운동량) 을 동시에 정확히 측정할 수 없다는 뜻이다.

<br>

이러한 단점을 보완한 것이 웨이블릿 분석 (wavelet analysis) 이다. 시간폭을 주파수 대역에 따라 가변적으로 조절하여 분석하는 기법이다.  

웨이블릿 분석은 단시간 푸리에 변환에 비해 저주파 대역에서의 주파수 해상도와 고주파 대역에서의 시간 정밀도가 상대적으로 높아 더 우수한 시간-주파수 분석 결과를 도출해낼 수 있다.

<br>

뇌파는 특정 뇌의 상태이거나 특정 인지 기능을 수행할 때 주로 연관된 주파수 성분이 있다. 
+ 세타 대역 : 주로 작업 기억과 관련
+ 알파 대역 : 각성 수준 및 다양한 인지 기능을 준비하는 기능
+ 베타 대역 : 운동 조절
+ 감마 대역 : 작업 기억 및 원거리 기능적 연결

등이 있다. 따라서 뇌파의 주파수는 특정 기능을 수행하고 근거리 혹은 원거리 신경세포 집단들과의 조화와 협력을 위해 능동적으로 발생시킨다고 봐도 무방할 것이다. 예시로 특정 주파수 대역의 자극을 가하여 특정 뇌 기능을 조절하는 연구도 이를 지지하는 결과라 볼 수 있다.

두피에서 측정한 전위는 실제 대뇌피질에서 발생한 신호원 위치 및 분포를 추정하기에는 무리가 있다. 그래서 수학적인 모델을 통해 전류 신호원의 위치를 추정하게 되는데 이를 **전류원국지화 기법**이라고 한다.

<br>

이처럼 다양한 뇌파의 정량적 특성들은 결국 다양한 통계 기법들을 적용시켜 질병을 분류하거나 예측하는 데 사용된다. 그러므로 적절한 통계 기법을 선택하여 적용하는 것이 중요한 것이다.  

최근에는 정량적 특성을 추출하지 않거나 아주 기본적인 특성만을 이용하여 데이터 자체를 학습함으로써 분류나 예측을 시도하고 있는데 이러한 방법을 **기계 학습 ; ML** 이라고 한다. 

<br>
<br>
<br>

<a name="시간분해능">1</a> : 시간 분해능은 신호의 타이밍을 정확하게 포착하는 측정 기술의 능력을 의미한다. EEG 는 거의 실시간으로 신호의 변화에 대한 정확한 정보를 제공할 수 있는 높은 시간 분해능을 가진 기술의 한 예이다.

<a name="주파수분해능">2</a> : 공간 분해능과 다른 개념임을 알아야 한다. 주파수 분해능은 각 신호가 가진 서로 다른 주파수를 구별하는 능력을 말하며, 공간 분해능은 공간에서 신호원의 위치를 정확하게 찾는 능력을 의미한다.



